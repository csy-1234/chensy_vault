ls /usr/lib64/mysql/plugin/		//MySQL 插件库目录，主要存放 MySQL 的动态插件文件（通常是 .so 文件）,默认就有很多
rpm -ql mysql-community-server | grep semisync		//mysql下载的插件文件路径

都在/usr/lib64/mysql/plugin/MySQL插件目录下：
semisync_master.so		//半同步复制主库端插件，负责在主库提交事务时等待从库确认。
semisync_replica.so		
semisync_slave.so		//半同步复制从库插件
semisync_source.so

在主库
#加载插件
mysql> SHOW PLUGINS;	#查看 当前数据库实例已经加载的插件
mysql> INSTALL PLUGIN rpl_semi_sync_master SONAME 'semisync_master.so';		#可以通过 SQL 命令 INSTALL PLUGIN 插件名 SONAME '文件名' 加载；数据库具备半同步功能，但尚未启用
mysql> SHOW PLUGINS;		#看到插件已被加载
#启用半同步主库模式
mysql> SHOW GLOBAL VARIABLES LIKE '%semi%';		#查看全局系统变量，筛选出 与半同步复制（semi-sync replication）相关的配置变量
mysql> SET @@global.rpl_semi_sync_master_enabled=ON;	#实际开启半同步事务控制
mysql> SHOW GLOBAL VARIABLES LIKE '%semi%';



从节点
mysql> INSTALL PLUGIN rpl_semi_sync_slave SONAME 'semisync_slave.so'; #加载从库半同步主从复制插件
mysql> SHOW PLUGINS;	#看到半同步主从复制插件已添加
mysql> SHOW GLOBAL VARIABLES LIKE '%semi%';		#查看semi相关全局系统变量
mysql> SET @@global.rpl_semi_sync_slave_enabled=ON;		#设置开启半同步主从复制
mysql> SHOW GLOBAL VARIABLES LIKE '%semi%';

主节点
mysql> SHOW GLOBAL STATUS LIKE '%semi%';	#显示与 半同步复制（semi-sync replication） 相关的运行时状态，监控半同步复制工作情况
mysql> show master status;					#主库二进制日志（binlog）相关状态，是 MySQL 当前主库的二进制文件名和日志位置

从节点
#配置主库
mysql> stop slave;
mysql> CHANGE MASTER TO
MASTER_HOST='192.168.80.10',
MASTER_USER='root',
MASTER_PASSWORD='Linux@456.com',
MASTER_LOG_FILE='mysql-binlog.000002',
MASTER_LOG_POS=157;
mysql> start slave;

测试
在主节点创建数据库mydb：
mysql> CREATE DATABASE mydb CHARACTER SET 'utf8';
mysql> show databases;

从节点查看数据库是否复制成功：
mysql> show databases;

使用数据库mydb在主节点进行数据操作：
mysql> use mydb;
mysql> CREATE TABLE tb1 (id INT,name VARCHAR(100));


在主节点上观察：
mysql> SHOW GLOBAL STATUS LIKE '%semi%';


主节点继续操作：
mysql> INSERT INTO tb1 VALUES (1,'tom');
我们发现从节点的数据都在变化：
mysql> SHOW GLOBAL STATUS LIKE '%semi%';

