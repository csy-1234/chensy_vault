---
date: "20250910"
docx:
  - redis主从.docx
  - redis-cluster集群.docx
实验: 已做
---
[redis主从.docx](附件/缓存/3-redis主从.docx)
[redis-cluster集群.docx](附件/缓存/4-redis-cluster集群.docx)
# 主从复制
## 概念
![[Pasted image 20250910085332.png]]
> 主从架构的功能就是 **写入集中在主库，读取分摊到从库，同时提供数据备份、容灾和负载均衡能力**。复制在前读写分离在后

![[Pasted image 20250910085555.png]]

负载均衡
**主从架构**：不止读写分离这一种方向
- 主库负责写操作，从库负责读操作。
- 优点：减轻主库压力。
- 缺点：写压力集中在主库，容易成为瓶颈
**多主架构方向（多活 / 双主 / 多主复制）**
- 多个主节点同时可读可写。
- 优点：写入能力提升，可跨机房部署。
- 缺点：数据一致性、冲突解决复杂。
- 例子：MySQL Group Replication、Galera Cluster。
**分片（Sharding）方向**
- 把数据按规则（范围、哈希等）分布到多个节点。
- 优点：读写都能水平扩展。
- 缺点：查询和事务变复杂。
- 例子：MongoDB Sharding、MySQL Sharding。
**缓存方向**
- 通过缓存系统（Redis/Memcached）减少数据库直接压力。
- 其实也是一种“负载均衡”，把一部分请求转移出去。
**存储/计算分离方向**（新兴趋势）
- 存储层和计算层分开，计算节点可以弹性扩展。
- 优点：云环境下资源利用更灵活。

主从架构 = 主从复制 + （可选的读写分配）

![[Pasted image 20250910094553.png]]
## 实验
目的：搭建一主一从
效果：主节点写内容，从节点同步，从节点可以读不可写

![[e91db769114eb1420abcafe8a33eb6cc.jpg]]
![[77e2ef2166e699effa1270739c455b8b.jpg]]

# Redis集群
## 概念

![[Pasted image 20250910133338.png]]
总结：单机redis的高可用、容量问题、并发极限问题
![[Pasted image 20250910133540.png]]
总结：redis cluster集群采用hash槽分区
![[Pasted image 20250910134322.png]]
总结：cluster读写流程
![[Pasted image 20250910135728.png]]
cluster 集群提供主从复制功能
架构上来看：cluster是无中心的，主从架构是有中心的，开启主从复制的cluster集群是混合的的；

## 实验
目的：搭建cluster3主3从
机器：两台机器各装3redis
效果：主从复制+数据分片
 ![[1c8f91856153f2bf4aa4ca778343b48d.jpg]]
![[3b34002c0893940c6731a19b64dc631b.jpg]]
## 扩展

分布式系统的分类：

- 数据分布策略 → 复制 / 分片 / 混合
- 功能 → 存储 / 计算 / 缓存
- 架构 → 主从 / 无中心 / 混合